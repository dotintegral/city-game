(()=>{"use strict";var e,t={223:(e,t,n)=>{n(260);const o={mode:"view",modeData:void 0,map:{mapArray:[]},details:{money:1e5,date:new Date("01-01-2020"),dayDuration:3}};window._globalState=o;const a=e=>{o.modeData=void 0,o.mode=e.mode,"build"===e.mode&&(o.modeData=e.data),console.log({globalState:o})},s=(()=>{const e=new Phaser.Events.EventEmitter;return{on:(t,n)=>{e.on(t,n)},emit:(t,n)=>{e.emit(t,n)}}})();let i=0;const r="MainScene",d="UIScene",l="assets/tiles/green.png",c="assets/tiles/yellow.png",m="assets/tiles/selection.png",p="assets/buildings/house1.png",v="assets/buildings/block1.png",h="assets/tiles/roads.png",u=1e6,y=e=>({onPointerOver:()=>{var t;("build-road"===o.mode&&void 0===e.tileContent||"road"===(null===(t=e.tileContent)||void 0===t?void 0:t.type))&&(e.selection=e.scene.add.image(e.x,e.y,m),e.selection.setOrigin(0,1),e.selection.setDepth(e.zIndex+u),e.selection.setTint(1089552))},onPointerOut:()=>{var t,n;"build-road"===o.mode&&((null===(t=e.overlay)||void 0===t?void 0:t.destroy)&&(e.overlay.destroy(),e.overlay=void 0),(null===(n=e.selection)||void 0===n?void 0:n.destroy)&&(e.selection.destroy(),e.overlay=void 0))},onPointerDown:(t,n,a)=>{if("build-road"===o.mode){const t=(({verticalTriangle:e,horizontalTriangle:t})=>"up"===e?"right"===t?"ne":"nw":"right"===t?"se":"sw")({verticalTriangle:a<16?"up":"down",horizontalTriangle:n<32?"left":"right"});void 0===e.tileContent&&(e.tileContent={type:"road",roadPieces:[]}),"road"===e.tileContent.type&&(e.tileContent.roadPieces.includes(t)||e.tileContent.roadPieces.push(t));const o=(e=>{const t=t=>t.length===e.length&&t.every((t=>e.includes(t)));return 0===e.length?0:t(["ne","sw"])?1:t(["se","nw"])?2:t(["ne"])?4:t(["se"])?5:t(["sw"])?6:t(["nw"])?7:t(["ne","nw"])?8:t(["ne","se"])?9:t(["se","sw"])?10:t(["sw","nw"])?11:t(["ne","se","nw"])?12:t(["ne","se","sw"])?13:t(["se","sw","nw"])?14:t(["ne","sw","nw"])?15:3})(e.tileContent.roadPieces);void 0===e.content?e.content=e.scene.add.image(e.x,e.y,h,o):e.content.setFrame(o),e.content.setOrigin(0,1),e.content.setDepth(e.zIndex+5)}}}),g=e=>({onPointerOver:()=>{"demolish"===o.mode&&(e.selection=e.scene.add.image(e.x,e.y,m),e.selection.setOrigin(0,1),e.selection.setDepth(e.zIndex+u),e.selection.setTint(15732752),void 0!==e.content&&(e.content.setTint(15732752),e.content.setAlpha(.5)))},onPointerOut:()=>{var t,n,a;"demolish"===o.mode&&((null===(t=e.overlay)||void 0===t?void 0:t.destroy)&&(e.overlay.destroy(),e.overlay=void 0),(null===(n=e.selection)||void 0===n?void 0:n.destroy)&&(e.selection.destroy(),e.overlay=void 0),(null===(a=e.content)||void 0===a?void 0:a.clearTint)&&(e.content.clearTint(),e.content.clearAlpha()))},onPointerDown:()=>{var t;"demolish"===o.mode&&void 0!==e.content&&(null===(t=e.content)||void 0===t||t.destroy(),e.content=void 0)}}),b=Phaser.Input.Events;class f extends Phaser.GameObjects.Image{constructor({scene:e,x:t,y:n,zIndex:a,row:s,column:i}){var r;super(e,t,n,l),this.scene=e,this.zIndex=a,this.x=t,this.y=n,this.row=s,this.column=i,this.originX=0,this.originY=1,this.updateDisplayOrigin(),this.setDepth(a+0),this.setInteractive({pixelPerfect:!0,alphaTolerance:1}),this.eventHandlers=[(r=this,{onPointerOver:()=>{var e,t;"build"===o.mode&&void 0===r.content&&(r.overlay=r.scene.add.image(r.x,r.y,(null===(e=o.modeData)||void 0===e?void 0:e.buildable.sprite)||"",(null===(t=o.modeData)||void 0===t?void 0:t.buildable.frame)||0),r.overlay.setOrigin(0,1),r.overlay.setAlpha(.5),r.overlay.setDepth(r.zIndex+1000001),r.selection=r.scene.add.image(r.x,r.y,m),r.selection.setOrigin(0,1),r.selection.setDepth(r.zIndex+u),r.selection.setTint(1089552))},onPointerOut:()=>{var e,t;"build"===o.mode&&void 0===r.content&&((null===(e=r.overlay)||void 0===e?void 0:e.destroy)&&(r.overlay.destroy(),r.overlay=void 0),(null===(t=r.selection)||void 0===t?void 0:t.destroy)&&(r.selection.destroy(),r.overlay=void 0))},onPointerDown:()=>{var e,t,n,a;"build"===o.mode&&void 0===r.content&&(null===(e=r.overlay)||void 0===e||e.destroy(),r.overlay=void 0,r.content=r.scene.add.image(r.x,r.y,(null===(t=o.modeData)||void 0===t?void 0:t.buildable.sprite)||"",(null===(n=o.modeData)||void 0===n?void 0:n.buildable.frame)||0),r.content.setOrigin(0,1),r.content.setDepth(r.zIndex+5),(null===(a=r.selection)||void 0===a?void 0:a.destroy)&&(r.selection.destroy(),r.overlay=void 0))}}),g(this),y(this)],this.on(b.POINTER_OVER,(()=>{this.eventHandlers.forEach((e=>e.onPointerOver()))})),this.on(b.POINTER_OUT,(()=>{this.eventHandlers.forEach((e=>e.onPointerOut()))})),this.on(b.POINTER_DOWN,((e,t,n)=>{this.eventHandlers.forEach((o=>o.onPointerDown(e,t,n)))})),this.scene.add.existing(this)}}class w extends Phaser.Scene{constructor(){super({key:r})}create(){this.keyBindings=(e=>{const t={};return{bindKeys:()=>{e.input.keyboard.on("keydown",(({key:e})=>{t[e]=!0})).on("keyup",(({key:e})=>{t[e]=!1})),e.input.on("wheel",((t,n,o,a,s,i)=>{a>0?e.cameras.main.zoom>.2&&(e.cameras.main.zoom-=.1):a<0&&e.cameras.main.zoom<2&&(e.cameras.main.zoom+=.1)}))},handleCameraMovement:()=>{t.w?e.cameras.main.scrollY-=10:t.s&&(e.cameras.main.scrollY+=10),t.a?e.cameras.main.scrollX-=10:t.d&&(e.cameras.main.scrollX+=10)}}})(this),this.createTiles(),this.keyBindings.bindKeys(),this.cameras.main.setName("world")}createTiles(){const e=this.cameras.main.width/2;for(let t=0;t<32;t++){const n=e-32*t,a=100+16*t;o.map.mapArray.push([]);for(let e=0;e<32;e++){const s=new f({scene:this,x:n+32*e,y:a+16*e,zIndex:10*(t+e+1),row:t,column:e});o.map.mapArray[t].push(s)}}}update(){this.keyBindings.handleCameraMovement()}}class C extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){this.load.image(l,l),this.load.image(c,c),this.load.image(m,m),this.load.image(p,p),this.load.image(v,v),this.load.spritesheet(h,h,{frameWidth:64,frameHeight:32})}create(){this.scene.start(r),this.scene.start(d)}}class x extends Phaser.GameObjects.Text{constructor(e){super(e,10,10,"",{color:"black",fontSize:"18px"}),e.add.existing(this),this.setOrigin(0)}update(){this.setText(`${Math.floor(this.scene.game.loop.actualFps)} fps`)}}const B=()=>{const e=document.querySelector(".bottomBarDateItem"),t=o.details.date,n=`${t.getDate()}.${t.getMonth()+1}.${t.getFullYear()}`;e.textContent=n;const a=document.querySelector(".bottomBarMoneyItem"),s=`â‚¬${o.details.money.toFixed(2)}`;a.textContent=s},T={buildings:{house1:{sprite:p,name:"House 1",frame:0},block1:{sprite:v,name:"Block 1",frame:0}},roads:{road0:{sprite:"roads",name:"road 0",frame:0},road1:{sprite:"roads",name:"road 1",frame:1},road2:{sprite:"roads",name:"road 2",frame:2},road3:{sprite:"roads",name:"road 3",frame:3},road4:{sprite:"roads",name:"road 4",frame:4},road5:{sprite:"roads",name:"road 5",frame:5},road6:{sprite:"roads",name:"road 6",frame:6},road7:{sprite:"roads",name:"road 7",frame:7},road8:{sprite:"roads",name:"road 8",frame:8},road9:{sprite:"roads",name:"road 9",frame:9},road10:{sprite:"roads",name:"road 10",frame:10}}},E=()=>{const e=document.querySelector(".selectionBarContainer");e&&(e.innerHTML="")},O=e=>{E();const t=document.createElement("div");t.className="selectionBar";const n=(e=>{const t=document.createElement("div");t.className="selectionBarTitleBar";const n=document.createElement("div");n.className="selectionBarTitleBarTitle",n.innerText=e;const o=document.createElement("div");return o.className="selectionBarTitleBarCloseButton",o.innerText="X",o.addEventListener("click",(()=>{E(),a({mode:"view"})})),t.appendChild(n),t.appendChild(o),t})(e);if(t.appendChild(n),"build"===e){const e=(()=>{const e=Object.keys(T.buildings).map((e=>{const t=T.buildings[e],n=document.createElement("div");return n.className="selectionBarItem",n.innerHTML=`\n      <div class="selectionBarItemImage" style="background-image: url(${t.sprite})">\n      </div>\n      <div class="selectionBarItemName">\n        ${t.name}\n      </div>\n    `,n.addEventListener("click",(()=>{a({mode:"build",data:{buildable:t}})})),n})),t=document.createElement("div");return t.className="selectionBarContent",e.forEach((e=>{t.appendChild(e)})),t})();t.appendChild(e)}if("roads"===e){const e=(()=>{const e=document.createElement("div");e.className="selectionBarItem",e.innerHTML='\n      <div class="selectionBarItemName">\n        Road\n      </div>\n    ',e.addEventListener("click",(()=>{a({mode:"build-road"})}));const t=document.createElement("div");return t.className="selectionBarContent",t.appendChild(e),t})();t.appendChild(e)}const o=document.querySelector(".selectionBarContainer");null==o||o.appendChild(t)},P=()=>{const e=document.createElement("div");return e.className="selectionBarContainer",{selectionBarContainer:e,openSelectionBar:O,closeSelectionBar:E}},k=({name:e,caption:t,callback:n})=>{const o=document.createElement("div");return o.className="leftMenuButton",o.innerText=t,o.addEventListener("click",n),o},D=e=>({create:()=>{(e=>{const{selectionBarContainer:t,openSelectionBar:n,closeSelectionBar:o}=P(),s=document.createElement("div");s.className="leftMenuWrapper";const i=document.createElement("div");i.className="leftMenu",i.appendChild(k({name:"roads",caption:"Roads",callback:()=>{o(),n("roads"),a({mode:"view"})}})),i.appendChild(k({name:"build",caption:"Build",callback:()=>{o(),n("build"),a({mode:"view"})}})),i.appendChild(k({name:"demolish",caption:"DMLSH",callback:()=>{o(),a({mode:"demolish"})}})),i.appendChild(k({name:"tbd",caption:"TBD",callback:()=>{o()}})),s.appendChild(i),s.appendChild(t);const r=e.add.dom(0,100,s);r.originX=0,r.originY=0})(e),(e=>{const t=document.createElement("div");t.className="bottomBar";const n=document.createElement("div");n.className="bottomBarWrapper",n.appendChild(t),(()=>{const e=document.createElement("div");e.className="bottomBarDateItem";const t=document.createElement("div");return t.className="bottomBarMoneyItem",[e,t]})().forEach((e=>{t.appendChild(e)}));const o=e.add.dom(140,700,n);o.originX=0,o.originY=0,B(),setInterval(B,500)})(e)}});class I extends Phaser.Scene{constructor(){super({key:d}),this.ui=D(this)}create(){this.ui.create(),this.fpsText=new x(this)}update(){this.fpsText.update()}}const N={type:Phaser.AUTO,backgroundColor:"#303030",dom:{createContainer:!0},parent:"phaser-game",scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:1280,height:720},scene:[C,w,I],physics:{default:"arcade",arcade:{debug:!1,gravity:{y:1e3}}}};window.addEventListener("load",(()=>{new Phaser.Game(N)})),(()=>{const e=()=>{setTimeout((()=>{e();try{(e=>{e-i>1e3*o.details.dayDuration&&(i=e,o.details.date.setDate(o.details.date.getDate()+1),s.emit("dayChanged",o.details.date))})((new Date).getTime())}catch(e){console.error(e)}}),100)};e()})()}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var s=n[e]={exports:{}};return t[e].call(s.exports,s,s.exports,o),s.exports}o.m=t,e=[],o.O=(t,n,a,s)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,a,s]=e[c],r=!0,d=0;d<n.length;d++)(!1&s||i>=s)&&Object.keys(o.O).every((e=>o.O[e](n[d])))?n.splice(d--,1):(r=!1,s<i&&(i=s));if(r){e.splice(c--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,a,s]},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var a,s,[i,r,d]=n,l=0;if(i.some((t=>0!==e[t]))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(d)var c=d(o)}for(t&&t(n);l<i.length;l++)s=i[l],o.o(e,s)&&e[s]&&e[s][0](),e[i[l]]=0;return o.O(c)},n=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=o.O(void 0,[216],(()=>o(223)));a=o.O(a)})();